{"version":3,"sources":["storage/user.js","utils/uuid.js","utils/eventListenerClass.js","components/chat/chatHistory/store.js","utils/socket.js","utils/webRTC.js","components/login/index.js","components/usersList/index.js","components/videoGrid/videoBox/index.js","components/videoGrid/streamControls/assets/camera.svg","components/videoGrid/streamControls/assets/microphone.svg","components/videoGrid/streamControls/index.js","components/videoGrid/index.js","components/chat/chatHistory/index.js","components/chat/chatInput/index.js","components/chat/index.js","App.js","reportWebVitals.js","index.js"],"names":["user_instance","this","_eventListeners","_user","id","name","room","roomId","_localStream","value","window","location","pathname","substr","s4","Math","floor","random","toString","uuid","EventListenerClass","type","handler","undefined","push","filter","i","chatHistory_instance","_log","data","time","Date","forEach","socket_instance","onConnect","socket","connected","onError","onLogged","onRoomData","users","onBeforeUnload","emit","onMessage","sendNewMessage","message","text","sendRTCOverSocket","to","JSON","stringify","user","io","reconnectionDelayMax","on","socketReceived","webRTC_newPeer","username","webRTC_instance","peers","hasOwnProperty","channel","close","e","console","error","_streams","_connectionsCount","server","iceServers","url","credential","log","count","keys","stream","a","createConnection","pc","connection","initMedia","createOffer","then","offer","setLocalDescription","catch","initConnection","json","parse","remoteCandidateReceived","remoteOfferReceived","remoteAnswerReceived","answer","setRemoteDescription","candidate","addIceCandidate","createAnswer","sdpType","onicecandidate","event","candidateCache","localDescription","length","oniceconnectionstatechange","iceConnectionState","connectionsCount","onnegotiationneeded","signalingState","ontrack","streams","addStream","localVideo","document","getElementById","srcObject","localStream","getTracks","track","addTrack","RTCPeerConnection","Login","useState","setUsername","setError","setConnected","useEffect","addEventListener","onConnectionChange","removeEventListener","handlerOnClick","connect","className","htmlFor","style","color","placeholder","onChange","target","onKeyDown","keyCode","required","onClick","UserList","usersList","setUsersList","onUsersChange","map","VideoBox","videoId","title","videoEl","useRef","handleStream","current","getStream","ref","autoPlay","muted","StreamControls","getVideoTracks","enabled","video","setVideo","audio","setAudio","videoTrack","audioTrack","getAudioTracks","backgroundColor","src","camera_icon","alt","microphone_icon","VideoGrid","selectedVideo","handleClick","ChatHistory","messages","setMessages","v","getHours","getMinutes","whiteSpace","AutoTextArea","textAreaRef","setText","textAreaHeight","setTextAreaHeight","scrollHeight","sendMessage","msg","trim","rows","height","flexGrow","split","shiftKey","preventDefault","Chat","App","logged","setLogged","navigator","mediaDevices","getUserMedia","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.7dda5761.chunk.js","sourcesContent":["import {uuid} from \"../utils/uuid\";\r\n\r\nclass user {\r\n    constructor() {\r\n        this._eventListeners = {};\r\n        this._user = {id: '', name: '', room: this.roomId};\r\n        this._localStream = null;\r\n    }\r\n\r\n    get localStream() {\r\n        return this._localStream;\r\n    }\r\n\r\n    set localStream(value) {\r\n        this._localStream = value;\r\n    }\r\n\r\n    get user() {\r\n        return this._user;\r\n    }\r\n\r\n    set user(value) {\r\n        this._user = value;\r\n    }\r\n\r\n    get roomId() {\r\n        let room = window.location.pathname.substr(1);\r\n        if (!room) {\r\n            room = uuid();\r\n            window.location = room;\r\n        }\r\n        return room;\r\n    }\r\n}\r\n\r\nexport const user_instance = new user();","\r\nexport const uuid = function() {\r\n    const s4 = function () {\r\n        return Math.floor(Math.random() * 0x10000).toString(16);\r\n    };\r\n    return `${s4()}${s4()}-${s4()}-${s4()}-${s4()}-${s4()}${s4()}${s4()}`;\r\n}","export default class EventListenerClass{\r\n    constructor() {\r\n        this._eventListeners = {};\r\n    }\r\n\r\n    addEventListener(type, handler) {\r\n        if (this._eventListeners[type] === undefined)\r\n            this._eventListeners[type] = [];\r\n        this._eventListeners[type].push(handler);\r\n    }\r\n\r\n    removeEventListener(type, handler) {\r\n        this._eventListeners[type] = this._eventListeners[type]\r\n            .filter(i => i.toString() !== handler.toString());\r\n    }\r\n}","import EventListenerClass from \"../../../utils/eventListenerClass\";\r\n\r\nclass store  extends EventListenerClass{\r\n    constructor() {\r\n        super();\r\n        this._eventListeners = {};\r\n        this._log = [];\r\n        //this._onLogChange = onLogChange;\r\n    }\r\n\r\n    get log() {\r\n        return this._log;\r\n    }\r\n\r\n    push(value) {\r\n        value.data.time = new Date(value.data.time);\r\n        this._log.push(value);\r\n        this._eventListeners['newMessage']?.forEach(i => i(value));\r\n        this._eventListeners['newMessages']?.forEach(i => i(this._log));\r\n    }\r\n}\r\n\r\nexport const chatHistory_instance = new store();","import {io} from \"socket.io-client\";\r\nimport {webRTC_newPeer, socketReceived} from \"./webRTC\";\r\nimport {user_instance} from \"../storage/user\";\r\nimport {chatHistory_instance} from \"../components/chat/chatHistory/store\";\r\nimport EventListenerClass from \"./eventListenerClass\";\r\n\r\nconst ENDPOINT = \"https://webrtc-chat-api.herokuapp.com:4001\";\r\n\r\n\r\nclass socket extends EventListenerClass {\r\n    constructor() {\r\n        super();\r\n        this._eventListeners = {};\r\n        this.socket = io(ENDPOINT, {\r\n            reconnectionDelayMax: 10000\r\n        });\r\n        this.socket.on(\"connect\", this.onConnect);\r\n        this.socket.on(\"disconnect\", this.onConnect);\r\n    }\r\n\r\n    connect({user, room}) {\r\n        if (!this.socket.connected) {\r\n            return;\r\n        }\r\n        this.socket.on(\"webrtc\", socketReceived);\r\n        this.socket.on(\"webrtc_new_peer\", webRTC_newPeer);\r\n        this.socket.on(\"roomData\", this.onRoomData);\r\n        this.socket.on(\"message\", this.onMessage);\r\n        this.socket.on(\"logged\", this.onLogged);\r\n        this.socket.on(\"error\", this.onError);\r\n\r\n\r\n        // Сразу отправляем запрос на вход в комнату\r\n        this.socket.emit(\"join\", JSON.stringify({username: user, room: room}));\r\n    }\r\n\r\n    onConnect = (data) => {\r\n        this._eventListeners['connectionChange']?.forEach(i => {\r\n            i(this.socket.connected);\r\n        });\r\n    }\r\n\r\n    onError = (data) =>  {\r\n        this._eventListeners['error']?.forEach(i => {\r\n            i(data);\r\n        });\r\n    }\r\n\r\n    onLogged = (data) =>  {\r\n        this._eventListeners['logged']?.forEach(i => {\r\n            i(data);\r\n        });\r\n    }\r\n\r\n    onRoomData = (data) =>  {\r\n        this._eventListeners['usersChange']?.forEach(i => {\r\n            i(data.users);\r\n        });\r\n    }\r\n\r\n    onBeforeUnload = () =>  {\r\n        this.socket.emit('disconnect');\r\n    }\r\n\r\n\r\n    onMessage = (data) =>  {\r\n        chatHistory_instance.push(data);\r\n    }\r\n\r\n    sendNewMessage = (message) =>  {\r\n        socket_instance.socket.emit(\"sendMessage\", {text: message});\r\n    }\r\n\r\n    sendRTCOverSocket = (to, type, message) =>  {\r\n        socket_instance.socket.emit(\"webrtc\", JSON.stringify({id: user_instance.user.id, to: to, type: type, data: message}));\r\n    }\r\n}\r\n\r\nexport const socket_instance = new socket();","import {socket_instance} from \"./socket\";\r\nimport EventListenerClass from \"./eventListenerClass\";\r\nimport {user_instance} from \"../storage/user\";\r\n\r\n\r\nclass webRTC extends EventListenerClass {\r\n    constructor() {\r\n        super();\r\n        this._streams = {};\r\n        this._eventListeners = {};\r\n        this._connectionsCount = 0;\r\n        this.peers = {};\r\n        this.server = {\r\n            iceServers: [{\r\n                url: \"turn:217.150.77.131:3478\",\r\n                username: \"turnclient\",\r\n                credential: \"$0mep@$$w0rd\"\r\n            },\r\n                {url: \"stun:217.150.77.131:3478\"},\r\n                {url: 'stun:stun.l.google.com:19302'},\r\n                {url: 'stun:stun1.l.google.com:19302'},\r\n                {url: 'stun:stun2.l.google.com:19302'},\r\n                {url: 'stun:stun3.l.google.com:19302'},\r\n                {url: 'stun:stun4.l.google.com:19302'},\r\n            ]\r\n        };\r\n        console.log('webRTC created!');\r\n    }\r\n\r\n    get connectionsCount() {\r\n        return this._connectionsCount;\r\n\r\n    }\r\n\r\n    set connectionsCount(value) {\r\n        this._connectionsCount = value;\r\n        this._eventListeners['connectionsChange']?.forEach(i => {\r\n            i({\r\n                count: this._connectionsCount,\r\n                peers: this.peers.keys\r\n            })\r\n        });\r\n    }\r\n\r\n    addStream(id, stream) {\r\n        this._streams[id] = stream;\r\n        this._eventListeners[`streamAdded-${id}`]?.forEach(i => {\r\n            if (this._streams[id] !== undefined)\r\n                i(this._streams[id])\r\n        });\r\n    }\r\n\r\n    getStream(id) {\r\n        return this._streams[id];\r\n    }\r\n\r\n    onBeforeUnload = () => {\r\n        for (let id in webRTC_instance.peers) {\r\n            if (webRTC_instance.peers.hasOwnProperty(id)) {\r\n                if (webRTC_instance.peers[id].channel !== undefined) {\r\n                    try {\r\n                        webRTC_instance.peers[id].channel.close();\r\n                    } catch (e) {\r\n                        console.error(e);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport const webRTC_instance = new webRTC();\r\n\r\n\r\nexport async function webRTC_newPeer({user, data}) {\r\n    if (user !== 'SERVER')\r\n        return;\r\n\r\n    console.log('Creating new peer', [user, data]);\r\n    createConnection(data.id);\r\n    const pc = webRTC_instance.peers[data.id].connection;\r\n\r\n    await initMedia(data.id, pc);\r\n    await pc.createOffer().then(offer => {\r\n        return pc.setLocalDescription(offer)\r\n            .catch(error => console.error('Error set local description', error));\r\n    }).catch(error => console.error('Error create offer', error));\r\n    initConnection(data.id, \"offer\", pc);\r\n\r\n}\r\n\r\nexport function socketReceived(data) {\r\n    const json = JSON.parse(data);\r\n    console.log('socketReceived:', json);\r\n    switch (json.type) {\r\n        case \"candidate\":\r\n            remoteCandidateReceived(json.id, json.data);\r\n            break;\r\n        case \"offer\":\r\n            remoteOfferReceived(json.id, json.data);\r\n            break;\r\n        case \"answer\":\r\n            remoteAnswerReceived(json.id, json.data);\r\n            break;\r\n        default:\r\n            console.log(`Unknown type received from socket:`);\r\n            console.log(json);\r\n            break;\r\n    }\r\n}\r\n\r\nexport async function remoteAnswerReceived(id, answer) {\r\n    console.log('Remote answer received', [id, answer]);\r\n\r\n    const pc = webRTC_instance.peers[id].connection;\r\n    await pc.setRemoteDescription(answer).catch(error => console.error('Error set remote description', error));\r\n}\r\n\r\nexport async function remoteCandidateReceived(id, candidate) {\r\n    console.log('Remote offer received', [id, candidate])\r\n\r\n    createConnection(id);\r\n    const pc = webRTC_instance.peers[id].connection;\r\n    await pc.addIceCandidate(candidate).catch(error => console.error('Error add iceCandidate', error));\r\n}\r\n\r\nexport async function remoteOfferReceived(id, offer) {\r\n    console.log('Remote offer received', [id, offer]);\r\n\r\n    createConnection(id);\r\n    const pc = webRTC_instance.peers[id].connection;\r\n    await initMedia(id, pc)\r\n    await pc.setRemoteDescription(offer).then(() => {\r\n        pc.createAnswer().then(answer => {\r\n            return pc.setLocalDescription(answer)\r\n                .catch(error => console.error('Error set local description', error));\r\n        }).catch(error => console.error('Error create answer', error));\r\n    }).catch(error => console.error('Error set remote description', error));\r\n\r\n    initConnection(id, \"answer\", pc);\r\n\r\n}\r\n\r\nfunction initConnection(id, sdpType, pc) {\r\n    pc.onicecandidate = function (event) {\r\n        if (event.candidate) {\r\n            webRTC_instance.peers[id].candidateCache.push(event.candidate);\r\n        } else {\r\n            socket_instance.sendRTCOverSocket(id, sdpType, pc.localDescription);\r\n            for (let i = 0; i < webRTC_instance.peers[id].candidateCache.length; i++) {\r\n                socket_instance.sendRTCOverSocket(id, \"candidate\", webRTC_instance.peers[id].candidateCache[i]);\r\n            }\r\n        }\r\n    }\r\n    pc.oniceconnectionstatechange = function (event) {\r\n        switch (pc.iceConnectionState) {\r\n            case 'disconnected': {\r\n                delete webRTC_instance.peers[id];\r\n                webRTC_instance.connectionsCount = webRTC_instance.connectionsCount - 1;\r\n                console.log(`[${id}] disconnected! Peers: ${webRTC_instance.connectionsCount}`);\r\n                break;\r\n            }\r\n            case 'connected': {\r\n                webRTC_instance.connectionsCount = webRTC_instance.connectionsCount + 1;\r\n                console.log(`[${id}] connected! Peers: ${webRTC_instance.connectionsCount}`);\r\n                break;\r\n            }\r\n            default:\r\n                console.log(pc.iceConnectionState);\r\n                break;\r\n        }\r\n    }\r\n    pc.onnegotiationneeded = async function (event) {\r\n        if (pc.signalingState !== \"stable\") return;\r\n        pc.createOffer().then(offer => {\r\n            pc.setLocalDescription(offer).then(() => {\r\n                socket_instance.sendRTCOverSocket(id, sdpType, pc.localDescription);\r\n            }).catch(error => console.error('Error set local description', error));\r\n        }).catch(error => console.error('Error create offer', error));\r\n    }\r\n}\r\n\r\nasync function initMedia(id, pc) {\r\n\r\n    pc.ontrack = function ({streams: [stream]}) {\r\n        webRTC_instance.addStream(id, stream);\r\n    }\r\n\r\n    const localVideo = document.getElementById(`video-${user_instance.user.id}`);\r\n    if (localVideo) {\r\n        localVideo.srcObject = user_instance.localStream;\r\n    }\r\n    user_instance.localStream.getTracks().forEach(track => {\r\n        pc.addTrack(track, user_instance.localStream);\r\n    });\r\n}\r\n\r\nfunction createConnection(id) {\r\n    if (webRTC_instance.peers[id] === undefined) {\r\n        webRTC_instance.peers[id] = {\r\n            candidateCache: []\r\n        };\r\n        webRTC_instance.peers[id].connection =\r\n            new RTCPeerConnection(/*webRTC_instance.server, options*/);\r\n    }\r\n}\r\n","import React, {useEffect, useState} from 'react';\r\nimport './style.css';\r\nimport {socket_instance} from \"../../utils/socket\";\r\nimport {user_instance} from \"../../storage/user\";\r\n\r\nexport default function Login() {\r\n    const [username, setUsername] = useState('');\r\n    const [error, setError] = useState('');\r\n    const [connected, setConnected] = useState('');\r\n\r\n    useEffect(() => {\r\n        socket_instance.addEventListener('error', onError);\r\n        socket_instance.addEventListener('connectionChange', onConnectionChange);\r\n        return () => {\r\n            socket_instance.removeEventListener('error', onError);\r\n            socket_instance.removeEventListener('connectionChange', onConnectionChange);\r\n        };\r\n    }, []);\r\n\r\n    const onError = function (error) {\r\n        // eslint-disable-next-line default-case\r\n        switch (error.type) {\r\n            case 'addUser':\r\n                setError(error.error);\r\n                break;\r\n        }\r\n    }\r\n\r\n    const onKeyDown = function (event){\r\n        if (event.keyCode === 13) {\r\n            handlerOnClick();\r\n        }\r\n    }\r\n\r\n    const onConnectionChange = function (data) {\r\n        setConnected(data);\r\n    }\r\n\r\n    const handlerOnUsernameInput = function (event) {\r\n        setUsername(event.target.value);\r\n    }\r\n\r\n    const handlerOnClick = function (value) {\r\n        socket_instance.connect({user: username, room: user_instance.user.room});\r\n    }\r\n\r\n    return <div className={'Login'}>\r\n        <div className={'login-container'}>\r\n            <div className={'login-info-container'}>\r\n                <label htmlFor=\"uname\"><b>Username</b></label>\r\n                <label className=\"info-connected\" style={{color: connected ? '#B1D9CD' : '#FDB196'}}><b>{connected ? 'Connected' : 'Disconnected'}</b></label>\r\n            </div>\r\n            <input type=\"text\"\r\n                   placeholder=\"Enter Username\"\r\n                   onChange={handlerOnUsernameInput}\r\n                   onKeyDown={onKeyDown}\r\n                   required/>\r\n            <div className={'login-error'}>{error}</div>\r\n            <button type=\"submit\" onClick={handlerOnClick}>Login</button>\r\n        </div>\r\n    </div>\r\n}","import React, {useEffect, useState} from 'react';\r\nimport './style.css';\r\nimport {socket_instance} from \"../../utils/socket\";\r\n\r\nexport default function UserList() {\r\n    const [usersList, setUsersList] = useState([]);\r\n\r\n    useEffect(() => {\r\n        socket_instance.addEventListener('usersChange', onUsersChange);\r\n        return () => {\r\n            socket_instance.removeEventListener('usersChange', onUsersChange);\r\n        };\r\n    }, []);\r\n\r\n    const onUsersChange = (data) => {\r\n        setUsersList([...data]);\r\n    }\r\n\r\n    return <div className={'UsersList'}>\r\n        <div className={'users-list-container'}>\r\n            <ol className={\"users-list\"}>\r\n                {usersList.map(value =>\r\n                    <li key={value.id} className={'list-item'}>\r\n                        <div className={'user-item-gradient'}/>\r\n                        <div className={'user-item-content'}>\r\n                            <h4>{`${value.name}`}</h4>\r\n                        </div>\r\n                    </li>\r\n                )}\r\n            </ol>\r\n        </div>\r\n    </div>\r\n}","import React, {useEffect, useRef, useState} from 'react';\r\nimport './style.css';\r\nimport {webRTC_instance} from \"../../../utils/webRTC\";\r\n\r\nexport default function VideoBox({videoId, title, type, onClick}) {\r\n    const videoEl = useRef(null);\r\n    useEffect(() => {\r\n        webRTC_instance.addEventListener(`streamAdded-${videoId}`, handleStream);\r\n        if (videoEl !== null)\r\n            videoEl.current.srcObject = webRTC_instance.getStream(videoId);\r\n        return () => {\r\n            webRTC_instance.addEventListener(`streamAdded-${videoId}`, handleStream);\r\n        }\r\n    }, [])\r\n\r\n    const handleStream = function (stream) {\r\n        if (videoEl !== null)\r\n            videoEl.current.srcObject = stream;\r\n    }\r\n\r\n    const handleClick = function (event) {\r\n        onClick(event);\r\n    }\r\n\r\n    return (<article key={`article-${videoId}`} className=\"video-listing\">\r\n        <div onClick={handleClick}\r\n             id={`title-${videoId}`}\r\n             className=\"video-title\">{title}</div>\r\n        <div className=\"video-container\">\r\n            <video ref={videoEl} autoPlay muted={type === 'local'} className={`${type}-video`}\r\n                   id={`video-${videoId}`}/>\r\n        </div>\r\n    </article>);\r\n}","export default __webpack_public_path__ + \"static/media/camera.53281603.svg\";","export default __webpack_public_path__ + \"static/media/microphone.b5ad8492.svg\";","import React, {useState} from 'react';\r\nimport camera_icon from './assets/camera.svg';\r\nimport microphone_icon from './assets/microphone.svg';\r\nimport './style.css';\r\nimport {user_instance} from \"../../../storage/user\";\r\n\r\nexport default function StreamControls() {\r\n    const [video, setVideo] = useState(user_instance.localStream.getVideoTracks()[0].enabled);\r\n    const [audio, setAudio] = useState(user_instance.localStream.getVideoTracks()[0].enabled);\r\n    const videoTrack = user_instance.localStream.getVideoTracks()[0];\r\n    const audioTrack = user_instance.localStream.getAudioTracks()[0];\r\n\r\n    const toggleCamera = function () {\r\n        videoTrack.enabled = !videoTrack.enabled;\r\n        setVideo(videoTrack.enabled)\r\n    }\r\n\r\n    const toggleMic = function () {\r\n        audioTrack.enabled = !audioTrack.enabled;\r\n        setAudio(audioTrack.enabled);\r\n    }\r\n\r\n    return (<div className={'StreamControls'}>\r\n        <div className={'controls-container'}>\r\n            <div style={{backgroundColor: (video ? '#B1D9CD' : '#FDB196')}} className={'round-container'} onClick={toggleCamera}>\r\n                <img src={camera_icon} alt=\"camera icon\" />\r\n            </div>\r\n            <div style={{backgroundColor: (audio ? '#B1D9CD' : '#FDB196')}} className={'round-container'} onClick={toggleMic}>\r\n                <img src={microphone_icon} alt=\"microphone icon\"/>\r\n            </div>\r\n        </div>\r\n    </div>);\r\n}","import './style.css';\r\nimport React, {useEffect, useRef, useState} from \"react\";\r\nimport {socket_instance} from \"../../utils/socket\";\r\nimport {user_instance} from \"../../storage/user\";\r\nimport VideoBox from \"./videoBox/index\";\r\nimport StreamControls from \"./streamControls\";\r\n\r\nexport default function VideoGrid() {\r\n    const [usersList, setUsersList] = useState([]);\r\n    const selectedVideo = useRef(null);\r\n\r\n    useEffect(() => {\r\n        socket_instance.addEventListener('usersChange', onUsersChange);\r\n        return () => {\r\n            socket_instance.removeEventListener('usersChange', onUsersChange);\r\n        };\r\n    }, []);\r\n\r\n    const onUsersChange = (data) => {\r\n        setUsersList(data);\r\n    }\r\n\r\n    const handleClick = (event) => {\r\n        selectedVideo.current.srcObject = document.getElementById(`video-${event.target.id.substr(6)}`).srcObject;\r\n    }\r\n\r\n    return <div className={'VideoGrid'}>\r\n        <div className={\"video-row-container\"}>\r\n\r\n            <VideoBox title={user_instance.user.name}\r\n                      videoId={user_instance.user.id} onClick={handleClick}\r\n                      type={'local'}/>\r\n            {\r\n                usersList.filter(user => user.id !== user_instance.user.id).map(user =>\r\n                    <VideoBox title={user.name}\r\n                              videoId={user.id} onClick={handleClick}\r\n                              type={'remote'}/>\r\n                )\r\n            }\r\n\r\n        </div>\r\n        <div className={'selected-video-container'}>\r\n            <video ref={selectedVideo} autoPlay muted className=\"selected-video\" id=\"selected-video\"/>\r\n        </div>\r\n        <div className={'stream-controls-container'}>\r\n            <StreamControls/>\r\n        </div>\r\n    </div>;\r\n}","import React, {useEffect, useState} from 'react';\r\nimport './style.css';\r\nimport {chatHistory_instance} from \"./store\";\r\n\r\nexport default function ChatHistory() {\r\n    const [messages, setMessages] = useState([]);\r\n\r\n    useEffect(() => {\r\n        chatHistory_instance.addEventListener('newMessage', onMessage);\r\n        return () => {\r\n            chatHistory_instance.removeEventListener('newMessage', onMessage);\r\n        };\r\n    }, []);\r\n    const onMessage = (event) => {\r\n        setMessages(v => [...v, event]);\r\n    }\r\n\r\n    const formatTime = (time) => `${('0' + time.getHours()).substr(-2)}:${('0' + time.getMinutes()).substr(-2)}`\r\n\r\n    return <div className={'ChatHistory'}>\r\n        <div className={'chat-history-container'}>\r\n            {messages.map((data, i) =>\r\n                <div key={i}>\r\n                    <div className={'info-container'}>\r\n\r\n                        <div className={'user'}>{`${data.user}`}</div>\r\n                        <div className={'time'}>\r\n                            {formatTime(data.data.time)}\r\n                        </div>\r\n                    </div>\r\n                    <span style={{whiteSpace: 'pre-line'}} className={'message'}>{`${data.data.text}`}</span>\r\n                </div>\r\n            )}\r\n        </div>\r\n    </div>\r\n}","import React, {useEffect, useRef, useState,} from \"react\";\r\nimport './style.css'\r\nimport {socket_instance} from \"../../../utils/socket\";\r\n\r\nexport default function AutoTextArea() {\r\n    const textAreaRef = useRef(null);\r\n    const [text, setText] = useState(\"\");\r\n    const [textAreaHeight, setTextAreaHeight] = useState(\"auto\");\r\n\r\n    useEffect(() => {\r\n        setTextAreaHeight(`${textAreaRef.current.scrollHeight + 2}px`);\r\n    }, [text]);\r\n\r\n    const onChangeHandler = function (event) {\r\n        setTextAreaHeight(\"auto\");\r\n        setText(event.target.value);\r\n        console.log(text.split('\\r\\n'));\r\n    };\r\n\r\n    const onKeyDown = function (event) {\r\n        if (!event.shiftKey && event.keyCode === 13) {\r\n            sendMessage();\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    const sendMessage = function () {\r\n        const msg = text.trim();\r\n        if (msg.length === 0)\r\n            return;\r\n        socket_instance.sendNewMessage(msg);\r\n\r\n        setText('');\r\n        setTextAreaHeight(\"auto\");\r\n    }\r\n\r\n    return (\r\n        <div className={'AutoTextArea'}>\r\n            <div className={'text-area-container'}>\r\n\t\t\t<textarea className={'auto-text-area'}\r\n                      ref={textAreaRef}\r\n                      rows={1}\r\n                      style={{\r\n                          height: textAreaHeight,\r\n                          flexGrow: 1,\r\n                      }}\r\n                      value={text}\r\n                      onChange={onChangeHandler}\r\n                      onKeyDown={onKeyDown}\r\n            />\r\n                <button onClick={sendMessage}>Send</button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","import React from 'react';\r\nimport './style.css';\r\nimport ChatHistory from \"./chatHistory\";\r\nimport AutoTextArea from \"./chatInput\";\r\n\r\nexport default function Chat() {\r\n    return <div className={'Chat'}>\r\n        <ChatHistory/>\r\n        <AutoTextArea/>\r\n    </div>\r\n}","import './App.css';\nimport {useEffect, useState} from \"react\";\nimport {webRTC_instance} from \"./utils/webRTC\";\nimport Login from './components/login'\nimport {socket_instance} from \"./utils/socket\";\nimport UserList from \"./components/usersList\";\nimport VideoGrid from \"./components/videoGrid\";\nimport Chat from \"./components/chat\";\nimport {user_instance} from \"./storage/user\";\n\nfunction App() {\n    const [logged, setLogged] = useState(false)\n\n    const onLogged = (data) => {\n        user_instance.user = data.data;\n        setLogged(true);\n    }\n\n    useEffect(() => {\n        navigator.mediaDevices.getUserMedia({video: true, audio: true})\n            .then(stream => user_instance.localStream = stream)\n            .catch(error => console.error('Error get user media', error));\n\n        socket_instance.addEventListener('logged', onLogged);\n        if (!logged)\n            return;\n        window.addEventListener(\"beforeunload\", socket_instance.onBeforeUnload);\n        window.addEventListener(\"beforeunload\", webRTC_instance.onBeforeUnload);\n        return () => {\n            socket_instance.removeEventListener('logged', onLogged);\n            window.removeEventListener(\"beforeunload\", webRTC_instance.onBeforeUnload);\n            window.removeEventListener(\"beforeunload\", socket_instance.onBeforeUnload);\n        };\n    }, [logged]);\n\n    return <div className=\"App\"> {logged ? <>\n        <>\n            <div className='App-body'>\n                <div className={'video-grid-container'}>\n                    <VideoGrid/>\n                </div>\n                <div className={'info-chat-container'}>\n                    <UserList/>\n                    <Chat/>\n                </div>\n            </div>\n        </>\n    </> : <Login/>}\n    </div>;\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}